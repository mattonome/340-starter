

                <body>
                    <main class="management">
                        <h1>
                            <%= title %>
                        </h1>

                        <!-- Flash / Message Handling -->
                        <% if (messages && Object.keys(messages).length> 0) { %>
                            <div id="flash-messages">
                                <% Object.keys(messages).forEach(function(key) { const msgs=Array.isArray(messages[key]) ?
                                    messages[key] : [messages[key]]; const typeClass=key==='success_msg' ? 'success' :
                                    key==='error_msg' ? 'error' : key; %>
                                    <% msgs.forEach(function(message) { %>
                                        <div class="flash-item <%= typeClass %>">
                                            <span>
                                                <%= message %>
                                            </span>
                                            <button class="close-btn" onclick="this.parentElement.remove()">Ã—</button>
                                        </div>
                                        <% }) %>
                                            <% }) %>
                            </div>
                            <% } %>

                                <!-- Management Links -->
                                <section class="management-links">
                                    <h2>Inventory Management</h2>
                                    <ul>
                                        <li><a href="/inv/add-classification">Add New Classification</a></li>
                                        <li><a href="/inv/add-inventory">Add New Inventory Item</a></li>
                                    </ul>
                                </section>

                                <!-- Classification Dropdown & Table -->
                                <section class="inventory-management">
                                    <h2>Manage Existing Inventory</h2>

                                    <!-- Classification Dropdown -->
                                    <form id="classificationForm" action="/inv/management-table" method="get">
                                        <label for="classification_id">Select a Classification:</label>
                                        <select id="classification_id" name="classification_id"
                                            onchange="this.form.submit()">
                                            <option value="">-- Select --</option>
                                            <% if (classifications && classifications.length> 0) { %>
                                                <% classifications.forEach(classification=> { %>
                                                    <option value="<%= classification.classification_id %>"
                                                        <%=selectedClassification==classification.classification_id
                                                        ? 'selected' : '' %>>
                                                        <%= classification.classification_name %>
                                                    </option>
                                                    <% }) %>
                                                        <% } %>
                                        </select>
                                    </form>

                                    <!-- Vehicles Table -->
                                    <% if (vehicles && vehicles.length> 0) { %>
                                        <table class="inventory-table">
                                            <thead>
                                                <tr>
                                                    <th>Classification</th>
                                                    <th>Make</th>
                                                    <th>Model</th>
                                                    <th>Year</th>
                                                    <th>Price</th>
                                                    <th>Color</th>
                                                    <th>Miles</th>
                                                    <th>Edit</th>
                                                    <th>Delete</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% vehicles.forEach(vehicle=> { %>
                                                    <tr>
                                                        <td>
                                                            <%= vehicle.classification_name %>
                                                        </td>
                                                        <td>
                                                            <%= vehicle.inv_make %>
                                                        </td>
                                                        <td>
                                                            <%= vehicle.inv_model %>
                                                        </td>
                                                        <td>
                                                            <%= vehicle.inv_year %>
                                                        </td>
                                                        <td>$<%= Number(vehicle.inv_price).toLocaleString() %>
                                                        </td>
                                                        <td>
                                                            <%= vehicle.inv_color %>
                                                        </td>
                                                        <td>
                                                            <%= Number(vehicle.inv_miles).toLocaleString() %>
                                                        </td>
                                                        <td><a href="/inv/edit/<%= vehicle.inv_id %>">Edit</a></td>
                                                        <td>
                                                            <form action="/inv/delete/<%= vehicle.inv_id %>" method="post"
                                                                style="display:inline;">
                                                                <button type="submit"
                                                                    onclick="return confirm('Are you sure you want to delete this vehicle?');">
                                                                    Delete
                                                                </button>
                                                            </form>
                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                            </tbody>
                                        </table>
                                        <% } else if (selectedClassification) { %>
                                            <p>No vehicles found for this classification.</p>
                                            <% } %>
                                </section>
                    </main>

                    <script>
                        setTimeout(() => {
                            const flashContainer = document.getElementById('flash-messages');
                            if (flashContainer) flashContainer.remove();
                        }, 5000);
                    </script>
                </body>

                </html>